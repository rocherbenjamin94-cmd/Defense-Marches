[phases.setup]
nixPkgs = ["nodejs_20", "python3", "chromium", "nss", "freetype", "fontconfig", "pango", "cairo", "glib", "gtk3", "dbus", "xorg.libX11", "xorg.libXcomposite", "xorg.libXdamage", "xorg.libXext", "xorg.libXfixes", "xorg.libXrandr", "xorg.libxcb", "expat", "cups", "libdrm", "mesa", "alsa-lib", "at-spi2-atk", "at-spi2-core", "libxkbcommon"]

[phases.install]
cmds = ["npm install --legacy-peer-deps"]

[phases.build]
cmds = ["npm run build"]

[variables]
PUPPETEER_SKIP_CHROMIUM_DOWNLOAD = "true"
PUPPETEER_EXECUTABLE_PATH = "/nix/store/chromium/bin/chromium"

[start]
cmd = "node dist/main.js"
